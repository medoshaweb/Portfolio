! ROUTER - Router-on-a-stick, DHCP, default route to firewall
conf t
 hostname R1
 no ip domain-lookup

! Physical interface towards switches
 interface g0/0
  no shutdown
 exit

! Subinterfaces for Inter-VLAN routing
 interface g0/0.10
  encapsulation dot1Q 10
  ip address 192.168.10.1 255.255.255.0
 exit
 interface g0/0.20
  encapsulation dot1Q 20
  ip address 192.168.20.1 255.255.255.0
 exit
 interface g0/0.30
  encapsulation dot1Q 30 native
  ip address 192.168.30.1 255.255.255.0
 exit

! Interface towards firewall/edge
 interface g0/1
  ip address 10.0.0.2 255.255.255.252
  no shutdown
 exit

! DHCP pools per VLAN
 ip dhcp excluded-address 192.168.10.1 192.168.10.10
 ip dhcp excluded-address 192.168.20.1 192.168.20.10
 ip dhcp excluded-address 192.168.30.1 192.168.30.10

 ip dhcp pool VLAN10
  network 192.168.10.0 255.255.255.0
  default-router 192.168.10.1
  dns-server 8.8.8.8 1.1.1.1
 exit

 ip dhcp pool VLAN20
  network 192.168.20.0 255.255.255.0
  default-router 192.168.20.1
  dns-server 8.8.8.8 1.1.1.1
 exit

 ip dhcp pool VLAN30
  network 192.168.30.0 255.255.255.0
  default-router 192.168.30.1
  dns-server 8.8.8.8 1.1.1.1
 exit

! Static default route to Internet via firewall
 ip route 0.0.0.0 0.0.0.0 10.0.0.1

end
wr


